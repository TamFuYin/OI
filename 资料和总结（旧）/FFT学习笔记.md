# FFT学习笔记

在此我要强烈谴责那些把这东西讲得如此复杂的人

真的很简单，真的！~~（某个初二自学了微积分的人如是说道）~~

## 引入

#### 多项式和点值表示

你知道多项式吗，就是形如f(x)=a~0~x^0^+a~1~x^1^+a~2~x^2^+...+a~n~x^n^的式子。我们可以用(a~0~,a~1~,a~2~,...,a~n~)来唯一表示这个多项式，称为系数表示。

一个n次多项式实际相当于一个n+1元一次方程（如果把a看作未知数，而x是已知量），如果我们有n+1个这样的方程，那么我们就能解出来唯一的a。也就是说，如果我们随意找n+1个不同的x的取值，并带入算出多项式的值，也能表示一个多项式。也就是说，可以用{(x~0~,f(x~0~)),(x~1~,f(x~1~)),(x~2~,f(x~2~)),...,(x~n~,f(x~n~))}唯一表示这个多项式，称为点值表示。

让我们拭目以待看看这东西有什么用吧！

#### 多项式乘法

对于多项式f(x)=a~0~x^0^+a~1~x^1^+a~2~x^2^+...+a~n~x^n^和g(x)=b~0~x^0^+b~1~x^1^+b~2~x^2^+...+b~n~x^n^（次数不齐可以补零）的乘积h(x)=c~0~x^0^+c~1~x^1^+c~2~x^2^+...+c~n~x^n^

我们应用乘法分配律，得到对于$0\le i\le 2n,c_i=\sum_{0\le j\le i}a_j\cdot b_{i-j}$

这是O(n^2^)的，但是如果我们用点值表示，让我们看一下有什么不同吧！

易证，h可以表示为$\{(x_0,f(x_0)*g(x_0)),(x_1,f(x_1)*g(x_1)),(x_2,f(x_2)*g(x_2)),\cdots,(x_n,f(x_n)*g(x_n))\}$

太棒了ㄟ(≧◇≦)ㄏ，这是O(n)的，但是从系数表示转化为点值表示以及其逆过程的朴素办法同样是O(n^2^)的，我们需要一个快速的方法——FFT！

#### 复数和单位根

你一定知道复数吧，就是形如a+bi的数。

先给个我不会证的结论：任意复数$z=x+yi=re^{\theta i}$

（复指数函数$e^z=e^x(\cos y+i\sin y)$

其中(x,y)和(r,$\theta$)分别是其在复平面上的坐标和极坐标。r=|z|=$\sqrt{x^2+y^2}$又叫模长，$\theta=\arg(z),\tan\theta=\frac y x$又叫辐角。

复数乘法：$z_1z_2=r_1e^{\theta_1 i}r_2e^{\theta_2 i}=r_1r_2e^{(\theta_1+\theta_2) i}$

几何意义是模长相乘，辐角相加。

$z^n=1$的所有解被称为单位根。

首先写成$(re^{\theta i})^n=1$

即$r^ne^{n\theta i}=1$

通过奇妙的定理，这等价于$r^n=1且e^{n\theta i}=1$

前者显然r=1，也许后者你会通过$e^{n\theta i}=1=e^0$而得到$\theta =0$

但是不要忘了$n\theta$和$n\theta+2k\pi$是一个角！

所以事实上是$(n\theta+2k\pi)i=0$，解得$\theta=\frac{2k\pi}n$

（不要在意正负数啦，k=任意整数）

好，把r和$\theta$带进去，就得到$z=e^\frac{2k\pi i}n$

## DFT

好了回到正题，对于把系数表示转化为点值表示。

设f(x)=a~0~x^0^+a~1~x^1^+a~2~x^2^+...+a~n-1~x^n-1^。（其中n=2^s^，高位补零）

再设f~1~(x)=a~0~x^0^+a~2~x^1^+a~4~x^2^+...+a~n-2~x^n/2-1^,f~2~(x)=a~1~x^0^+a~3~x^1^+a~5~x^2^+...+a~n-1~x^n/2-1^

则f(x)=f~1~(x^2^)+f~2~(x^2^)x

把$\omega_n^k$带入x。

得$f(\omega_n^k)=f_1(\omega_n^{2k})+f_2(\omega_n^{2k})\omega_n^k=f_1(\omega_{n/2}^k)+f_2(\omega_{n/2}^k)\omega_n^k$

同理得$f(\omega_n^{k+n/2})=f_1(\omega_{n/2}^k)-f_2(\omega_{n/2}^k)\omega_n^k$

深入剖析f:{a~0~,a~1~,a~1~,a~1~,a~1~,a~1~}

然后分治地O(n log n)求吧！

## IDFT

对于把点值表示转化为系数表示。

即已知$y_i=f(\omega_n^i)$，求$\{a_0,a_1,\cdots,a_{n-1}\}$

构造$A(x)=\sum_{i=0}^{n-1}y_ix_i$

也就是把$\{y_0,y_1,\cdots\}$

设$b_i=\omega^{-i}_n$