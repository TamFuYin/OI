# 行列式

递归定义$n\times n$矩阵$A$的行列式$\det A=\sum_{i=1}^n(-1)^{1+i}A[1,i]\det A_{1,i}$。其中$A_{i,j}$是在A中删去第 i 行和第 j 列所得的矩阵。特殊的，对于 $1\times 1$ 矩阵，行列式就是它唯一的那个元素。另外，若定义A的代数余子式$C[i,j]=(-1)^{i+j}\det A_{i,j}$，则式子化为$\det A=\sum_{i=1}^nA[1,i]C[1,i]$。

从定义可以直接得到 $\det I=1$，其中$I$是恒等矩阵。

通过对矩阵的大小 n 施归纳法，可以证明如下性质，此处证明从略（都是暴力展开和式，即删去两行两列）：

1. 对于任意$i:1\le i\le n$,$\det A=\sum_{j=1}^nA[i,j]C[i,j]$，即按任意行展开，行列式不变。
2. $\det A=\sum_{i=1}^nA[i,1]C[i,1]$，即 $\det A=\det A^T$。

通过不断按列展开，可以得到上三角矩阵的行列式为主对角线上元素之积。

让我们观察一下行初等矩阵，这些行列式都可以归纳证明：

1. 对换矩阵，把两行对换，它的行列式是 -1。
2. 倍加矩阵，把一行的 r 倍加到另一行，它的行列式是1。
3. 倍乘矩阵，把一行乘以 r，它的行列式是 r。

同样通过归纳，选择一行未被改变的行展开行列式，可以得到若E是一个行初等矩阵，则$\det(EA)=(\det E)(\det A)$。

通过把可逆矩阵拆解为若干行初等矩阵之积并重新组合，有进一步推论：对于任意矩阵A,B：$\det(AB)=(\det A)(\det B)$。（不可逆矩阵的行列式为0，因为不可逆矩阵通过行初等变换最终可以得到一个零行，而用此零行展开行列式得到0）

但是计算行列式只需要用高斯消元把它化为一个上三角矩阵即可，行列式即为该上三角矩阵的迹乘(-1)^行交换的次数^。因为在这一过程中没有出现倍乘操作。


[关于行列式的定义](https://www.zhihu.com/question/52957345/answer/589376055)。

容易归纳证明上述定义与国内流行的基于置换的逆序对的定义等价。

# 特征值

A的特征值是满足存在非零解x使得$Ax=\lambda x$ 的$\lambda$的集合。

移项可以得到$(A-\lambda I)x=0$。而$(A-\lambda I)x=0$有非平凡解意味着 $A-\lambda I$ 有自由变量，又意味着 $A-\lambda I$ 不可逆，又意味着$\det(A-\lambda I)=0$。也就是说，特征值$\lambda$是方程 $\det(A-\lambda I)=0$ 的解。如果使用FFT等算法加速乘积，可以得到$O(N^4)$的算法。

# 矩阵树定理

令 $G$ 表示图。

定义度数矩阵 $D$ 为对角矩阵 $\mathrm{diag}(\deg 1,\deg 2,\dots,\deg n)$。其中 $\deg i$ 为 $i$ 的度数。

定义邻接矩阵 $A$ 为对称矩阵 $A[i,j]=\#e(i,j)$，其中 $\#e(i,j)$ 为 $i$ 与 $j$ 直接相连的边数。

定义拉普拉斯矩阵 $L=D-A$。

对于有向图，亦可类似定义入度拉普拉斯矩阵和出度拉普拉斯矩阵。

### Lemma #0(Binet-Cauchy)

是 $\det AB=\det A\det B$ 的拓展。

设 $n\times m$ 矩阵 $A$ 和 $m\times n$ 矩阵 $B$，则（这里使用 $[1,n]$ 表示 $1$ 到 $n$ 的整数，以及用 $A[S,T]$ 表示选择Ｓ中的行和Ｔ中的列组成的子矩阵）
$$
\det AB=\sum_{S\subseteq[1,m],|S|=n}\det A[[1,n],S]\cdot \det B[S,[1,n]]
$$
代数方法证明可以参考[这个](https://zhuanlan.zhihu.com/p/337464214)，但是OI-wiki使用了一种基于[LGV 引理](https://oi-wiki.org/graph/lgv/)的数形结合大法。

### Lemma #1

拉普拉斯矩阵 $L$ 的所有列向量 $\sum \boldsymbol c_i$ 加在一起等于 $\bold 0$。

由定义 $L=D-A$ ，观察每行（每个点）显然有。

因为 $L$ 是对称矩阵，所以对于行向量也有类似结论 $\sum \boldsymbol r_i=\bold 0$

### Lemma #2

拉普拉斯矩阵 $L$ 的所有代数余子式 $C[i,j]$ 相等。

先来证明 $C[i,j]=C[i,k]$。令 $\boldsymbol c_1,\boldsymbol c_2,\dots,\boldsymbol c_n$ 表示删去第 $i$ 行后 $L$ 的列向量。现在在 $L_{i,j}$中把除了 $\boldsymbol c_j$ 和 $\boldsymbol c_k$ 外的向量加到 $\boldsymbol c_k$ 上，由 Lemma #1，$L_{i,j}$ 变为 $[\boldsymbol c_1,\boldsymbol c_2,\dots,\boldsymbol c_{j-1},\boldsymbol c_{j+1},\dots,\boldsymbol c_{k-1},\boldsymbol -c_{j},\boldsymbol c_{k+1},\dots,\boldsymbol c_n]$。现在把 $-\boldsymbol c_j$ 取反并移到$\boldsymbol c_{j-1}$和$\boldsymbol c_{j+1}$之间。锵锵锵！我们得到了$L_{i,k}$！回顾这一过程中行列式发生的变化，倍加：不变，取反：乘上负一，挪移：需要让 $\boldsymbol c_j$ 依次（倒序）与$\boldsymbol c_{j+1},\dots,\boldsymbol c_{k-1}$ 交换两列，即 $(-1)^{k-1-(j+1)+1}$。总的变化就是乘上 $(-1)^{k-j}$。于是 $C[i,k]=(-1)^{i+k}\det A_{i,k}=(-1)^{i+k+k-j}\det A_{i,j}=C[i,j]$ 。

同理可证 $C[i,j]=C[k,j]$。

### a