# [Tohoku University Programming Contest 2023](https://atcoder.jp/contests/tupc2023)

## 012 Grid

å“‡ï¼Œè¿˜æœ‰è®¡æ•°

æ˜¾ç„¶ç­”æ¡ˆå³ä¸ºå¯»æ‰¾ä¸€ä¸ªåŒ…å« $(1,1)$ çš„é˜¶æ¢¯å½¢å’ŒåŒ…å« $(H,W)$ çš„é˜¶æ¢¯å½¢ä¸”ä¸¤è€…ä¸ç›¸è¿çš„æ–¹æ¡ˆæ•°ã€‚

å› æ­¤ç›¸å½“äºä¸¤æ¡ä» $(0,0)$ åˆ° $(H,W)$ çš„ä¸ç›¸äº¤æŠ˜çº¿è·¯å¾„æ•°é‡

è€ƒè™‘ **LGV å¼•ç†**ã€‚

æˆ‘ä»¬ä¸å¦¨é’¦å®š $(1,1)$ å’Œ $(H,W)$ éƒ½å¡« $1$ï¼Œè¿™æ ·èµ·ç‚¹é›†åˆä¸º $\{(0,1),(1,0)\}$ï¼Œç»ˆç‚¹é›†åˆä¸º $\{(H-1,W),(H,W-1)\}$ï¼Œä¸”å¦‚æœé”™å¼€æ¥ç›¸è¿ä¸å¯èƒ½å‡ºç°ä¸ç›¸äº¤è·¯å¾„ã€‚

![](https://img.atcoder.jp/tupc2023/2e5ce762cf415143c377572f28532566.png)

å› æ­¤ç­”æ¡ˆä¸º
$$
\det
\begin{bmatrix}
    \binom{H+W-2}{H-1}&\binom{H+W-2}{H}\\
    \binom{H+W-2}{H-2}&\binom{H+W-2}{H-1}
\end{bmatrix}
$$

å¯¹äºä¸€èˆ¬çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°åªæœ‰ä¸¤ç§æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ $0$ æˆ–è€… $2$ åŒ…è£¹ä½æ•´ä¸ªçŸ©é˜µï¼Œè¦ä¹ˆæ˜¯é‚£ä¸€æ¡ä¸œè¥¿åˆ†éš”å¼€ $0$ å’Œ $2$ã€‚

![](https://img.atcoder.jp/tupc2023/907941179ee38efbe7795e6cd281e655.png)

æ¨ä¸€ä¸‹å¼å­å°±èƒ½åšå®Œäº†

## Topological Sort

è€ƒè™‘è¿™ä¸ªæ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ

å¯¹äºä¸€ä¸ª $p_i$ï¼Œæˆ‘ä»¬çŸ¥é“

- $p_i$ çš„å…¥ç‚¹æ˜¯ $p_1,p_2,\dots,p_{i-1}$ çš„å­é›†
- $\forall j<p_i$ çš„å…¥ç‚¹ä¸æ˜¯ $p_1,p_2,\dots,p_{i-1}$ çš„å­é›†

æˆ‘ä»¬å…ˆè€ƒè™‘ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œç„¶åç­”æ¡ˆå°±æ˜¯ $\prod_{i=1}^n 2^{i-1}$ã€‚

å¯¹äºç¬¬äºŒä¸ªæ¡ä»¶ï¼Œè€ƒè™‘é¢„å¤„ç†å‡ºæ¯ä¸ª $j$ çš„è¦æ±‚çš„æœ€å¤§èŒƒå›´ $a_j$ã€‚

æ‰€ä»¥æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $\prod_{i=1}^n (2^{i-1}-2^{a_i})$ã€‚

## Shift Puzzle

è²Œä¼¼æ˜¯ç»å…¸é¢˜ã€‚

é¦–å…ˆè€ƒè™‘èƒ½å¦æ„é€ ä¸€ä¸ªäº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå›°éš¾ã€‚

ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªé¡ºä½ç½®æ¢ $3$ ä¸ªå‚ç›´å…ƒç´ çš„æ–¹æ³•ï¼Œä½¿ç”¨ $O(N)$ æ¬¡æ“ä½œ

![](https://img.atcoder.jp/tupc2023/0957891d6716afa5a13f4871e2775e3a.jpg)

å¦‚æœæ»¡è¶³ $X=Y$ï¼Œé‚£ä¹ˆå®é™…ä¸Šè¿™æ ·çš„æ“ä½œå°±æ˜¯äº¤æ¢äº† $X$ å’Œ $Z$ã€‚

å¦åˆ™ï¼Œå¿…ç„¶æ»¡è¶³ $Y=Z$ï¼Œå¯ä»¥å†å¤šæ“ä½œä¸€æ¬¡ï¼Œæˆ–è€…åå‘ã€‚

## And DNA

æ€è·¯å¾ˆå¥‡å¦™ã€‚

æˆ‘ä»¬å…ˆè€ƒè™‘**æœ€ä¸‹ä½ bit**ã€‚

ç„¶åå°±å˜æˆ $A_i\oplus(A_{i-1}\land A_{i+1})=M$ã€‚

å¦‚æœ $M=0$ï¼Œåˆ™è¦æ±‚ $A_i=A_{i-1}\land A_{i+1}=A_{i-2}\land A_i\land A_{i+2}=\cdots$ã€‚å› æ­¤åˆæ³•å½“ä¸”ä»…å½“ $A$ å…¨éƒ¨ç›¸ç­‰ã€‚

å¦åˆ™ï¼Œåˆ™è¦æ±‚å¥‡æ•°ä½ $A$ ä¸å¶æ•°ä½ $A$ åˆ†åˆ«ç›¸ç­‰è€Œä¸åŒï¼Œå¦‚æœ $N$ ä¸ºå¥‡æ•°åˆ™æ— è§£ã€‚

ç„¶åå°±å¾ˆå¥½è®¨è®ºäº†

## Hotel

æœ‰ç‚¹æŠ½è±¡äº†

é¦–å…ˆæŠŠ $x$ æ’åœ¨å‰é¢æœ‰ç‚¹æï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠåºåˆ—ç¿»è½¬ä¸€ä¸‹ï¼Œç°åœ¨æ“ä½œ 1 ä¼šæ’åœ¨æœ€åé¢ã€‚

ä½†æ˜¯è¿™ä¸ªæ“ä½œ 2 è¿˜æ˜¯å¾ˆæï¼Œè€ƒè™‘å¯¹åºåˆ—åš[ä½é€†åºç½®æ¢](https://oi-wiki.org/math/poly/fft/#%E4%BD%8D%E9%80%86%E5%BA%8F%E7%BD%AE%E6%8D%A2)ã€‚åšå®Œä¹‹åå°±å¯ä»¥ç›´æ¥ç”¨ Trie ç»´æŠ¤äº†

## Min Nim

Nim æ¸¸æˆï¼Œä½†æ˜¯ä½ éœ€è¦è®©æ“ä½œå®Œä¹‹åçš„é‚£å †æ˜¯æœ€å°å€¼ã€‚

è„‘ç­‹æ€¥è½¬å¼¯é¢˜ã€‚

é¦–å…ˆæ³¨æ„åˆ°å¦‚æœå…ˆæ‰‹ä¸€æ¬¡æŠŠä¸€å †æ“ä½œä¸ºé›¶ï¼Œåˆ™åé¢æˆ‘ä»¬æ¯æ¬¡åªèƒ½ç§»é™¤ä¸€æ•´å †ï¼Œå› æ­¤ $N$ ä¸ºå¥‡æ•°æ—¶å…ˆæ‰‹å¿…èƒœã€‚

å¦åˆ™ï¼Œç°åœ¨çš„è§„åˆ™æ˜¯ç¬¬ä¸€ä¸ªå–å®Œä¸€æ•´å †çš„ç©å®¶è¾“ã€‚

è€ƒè™‘å€’æ•°ä¸€æ­¥ï¼Œå‘ç°ç›¸å½“äºä½¿æ‰€æœ‰å †éƒ½æ˜¯ $1$ çš„ç©å®¶èµ¢ã€‚ç„¶åä½ å‘ç°è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªå…¨å±€å‡ä¸€ä¹‹åçš„åŸæ¸¸æˆã€‚

æˆ‘ä»¬ç›´æ¥ä¸€æ­¥åˆ°ä½å‡å»æœ€å°å€¼ï¼Œç„¶åæˆ‘ä»¬æ¯æ¬¡çš„æ“ä½œåªèƒ½ç§»é™¤ä¸€æ•´å †ï¼Œå› æ­¤åˆ¤æ–­æ­¤æ—¶ $>$ å…¨å±€æœ€å°å€¼çš„å…ƒç´ ä¸ªæ•°å³å¯ã€‚

## Count Pseudo-Palindromes

æ‰€è°“ã€Œæ‹Ÿå›æ–‡ã€å°±æ˜¯è‡³å¤šå­˜åœ¨ä¸€ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°ã€‚

å–„è‰¯çš„å‡ºé¢˜äººå·²ç»æŒ‡å®šäº†è¿™ä¸ªå…ƒç´ æ°ä¸º $A_i$ï¼Œä¸”æ¯ä¸ªå…ƒç´ æœ€å¤šå‡ºç°ä¸¤æ¬¡ã€‚

äºæ˜¯ç›¸å½“äºæ¯ä¸ªå…ƒç´ è¦ä¹ˆéƒ½å‡ºç°ï¼Œè¦ä¹ˆéƒ½ä¸å‡ºç°ï¼Œ$A_i$ é™¤å¤–ã€‚

è€ƒè™‘å¼‚æˆ–å“ˆå¸Œï¼Œåˆ™å¯ä»¥ $O(1)$ åˆ¤æ–­ä¸€ä¸ªåŒºé—´æ˜¯å¦åˆæ³•ã€‚

æˆ‘ä»¬å¯ä»¥è¯æ˜æå°çš„å¥‡æ‹Ÿå›æ–‡ä¸²çš„æ•°é‡æ˜¯ $O(N)$ çš„ã€‚

> è¯æ˜ï¼šå›ºå®š $r$ æ—¶ï¼Œä¸­å¿ƒ $i$ æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼ˆå³æœ€å¤§çš„è·¨è¿‡ $r$ çš„ç‚¹ï¼‰ï¼Œå› æ­¤æœ€å¤šè´¡çŒ® $1$ã€‚

ç„¶åé¢„å¤„ç†å‰ç¼€çš„å¼‚æˆ–å’Œä¸º $0$ çš„åç¼€æ•°é‡å’Œåç¼€çš„å¼‚æˆ–å’Œä¸º $0$ çš„å‰ç¼€æ•°é‡ï¼Œè¿™æ ·å°±åšå®Œäº†ã€‚

## Maximize Array

è€ƒè™‘æ‰¾åˆ°æ¨¡ $K$ åŒä½™äº $1$ çš„å…ƒç´ ä¸­çš„æœ€å°å€¼ï¼Œç„¶åæŠŠå®ƒå‰é¢çš„å…ƒç´ å…¨éƒ¨åˆ æ‰è®©å®ƒæˆä¸ºå¼€å¤´ã€‚

ç„¶åå®ƒå°±ç¡®å®šäº†ï¼Œå¯ä»¥æŠŠå®ƒåˆ æ‰ã€‚

é‡å¤è¿™ä¸ªæ“ä½œå³å¯ã€‚

## Colored Complete Graph

åŸæ¥ atcoder æœ‰äº¤äº’å•ŠğŸ˜®

å¯èƒ½æ˜¯ç¬¬ä¸€é“è‡ªå·±æƒ³å‡ºæ¥çš„æ™ºæ…§äº¤äº’

æˆ‘ä»¬å…ˆæ¥è¯æ˜ä¸€å®šå­˜åœ¨è§£ã€‚

å¦‚æœå­˜åœ¨ç»“ç‚¹ $u$ æ»¡è¶³åœ¨åªä¿ç•™èµ¤è‰²è¾¹çš„æƒ…å†µä¸‹ä¸è¿é€šï¼Œåˆ™å®ƒä¸å…¶ä»–ç»“ç‚¹çš„è¿è¾¹çš†ä¸ºé’è‰²ï¼Œäºæ˜¯å¾—åˆ°ä¸€ä¸ªåˆæ³•è§£ã€‚

å¯å‘ï¼Œæˆ‘ä»¬è€ƒè™‘è¯¢é—® $1$ çš„æ‰€æœ‰é‚»è¾¹ï¼Œå¦‚æœè¾¹çš„é¢œè‰²æ˜¯èµ¤è‰²ï¼Œåˆ™æ ‡æ³¨è¿™ä¸ªç‚¹ä¸ºèµ¤ç‚¹ï¼›å¦åˆ™ä¸ºé’ç‚¹ã€‚

è€ƒè™‘æŠŠå®ƒç”»æˆä¸€ä¸ªç±»ä¼¼äºŒéƒ¨å›¾çš„ä¸œè¥¿ã€‚

è€ƒè™‘æšä¸¾æ¯ä¸ªé’ç‚¹ï¼Œç„¶ååœ¨å³è¾¹æšä¸¾æ¯ä¸ªèµ¤ç‚¹ã€‚

å¦‚æœè¾¹çš„é¢œè‰²æ˜¯é’è‰²ï¼Œé‚£æˆ‘ä»¬ä¸æ€¥ï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªèµ¤ç‚¹ã€‚

å¦åˆ™ï¼Œæˆ‘ä»¬è·³åˆ°ä¸‹ä¸€ä¸ªé’ç‚¹ï¼Œç„¶å**ä»å½“å‰çš„èµ¤ç‚¹å¼€å§‹æ£€æŸ¥**ã€‚

å¦‚æœæ²¡æœ‰èµ¤ç‚¹ï¼Œåˆ™æˆ‘ä»¬å®£å¸ƒå·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªé’è‰²ç”Ÿæˆæ ‘ã€‚

å¦åˆ™ï¼Œå¦‚æœæ²¡æœ‰é’ç‚¹ï¼Œåˆ™å…¨éƒ¨é’ç‚¹å·²ç»è¿äº†ä¸€ä¸ªèµ¤ç‚¹ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªèµ¤è‰²ç”Ÿæˆæ ‘ã€‚

è¿™ä¸ªè¿‡ç¨‹å‡æ‘Šä½¿ç”¨äº† $\le N$ æ¬¡è¯¢é—®ã€‚

## (mod HW+1)

æœ‰ç‚¹å‰å®³ã€‚

è®° $M=HW+1$ï¼Œä¸å¦¨å‡è®¾ $H\le W$ã€‚

### è‹¥ $M$ æ˜¯åˆæ•°ï¼Œä¸”ä¸æ˜¯ç´ æ•°çš„å¹‚

æ­¤æ—¶åªæœ‰ $R=0$ æ˜¯åˆæ³•çš„ã€‚

ä¸”éœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸‰æ¡æ¡ä»¶ï¼š

$$
\lfloor H/2\rfloor\times \lfloor W/2\rfloor \le \lfloor HW/p\rfloor\\
$$

å› ä¸ºæ¯ä¸ª $2\times 2$ çš„æ–¹é˜µéƒ½è‡³å°‘è¦æœ‰ä¸€ä¸ª $p$ çš„å€æ•°ã€‚

$$
v_p(M)(H-1)(W-1)\le \sum_{n=1}^{HW} 4\times \min(v_p(n),v_p(M)),\operatorname{if} H\ge 3
\\
v_p(M)(H-1)(W-1)\le \sum_{n=1}^{HW} 2\times \min(v_p(n),v_p(M)),\operatorname{if} H= 2
\\
$$

### è‹¥ $M$ æ˜¯åˆæ•°ï¼Œä¸”æ˜¯ç´ æ•°çš„å¹‚

è®° $M=p^e$ åˆ™

- $R=0$ æ—¶ï¼Œéœ€è¦æ»¡è¶³
  $$
  e(H-1)(W-1)\le \sum_{n=1}^{HW}4\times \min(v_p(n),e),\operatorname{if} H\ge 3\\
  e(H-1)(W-1)\le \sum_{n=1}^{HW}2\times \min(v_p(n),e),\operatorname{if} H= 2\\
  $$
- $R$ ä¸º $p^{e-1}$ çš„å€æ•°æ—¶ï¼Œéœ€è¦æ»¡è¶³
  $$
  (e-1)(H-1)(W-1)\le \sum_{n=1}^{HW}4\times \min(v_p(n),e-1),\operatorname{if} H\ge 3\\
  (e-1)(H-1)(W-1)\le \sum_{n=1}^{HW}2\times \min(v_p(n),e-1),\operatorname{if} H= 2\\
  $$

### è‹¥ $M$ ä¸ºç´ æ•°

è€ƒè™‘ç¦»æ•£å¯¹æ•°ï¼Œä¸éš¾æ„é€ ã€‚

## Random Mex

è€ƒè™‘ mex ä¸º $k$ çš„æ¦‚ç‡

è€ƒè™‘å®¹æ–¥ï¼ŒæŠŠã€Œè‡³å°‘å‡ºç°ä¸€æ¬¡ã€å®¹æ–¥ä¸ºã€Œä¸å‡ºç°ã€ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º
$$
\sum_{i=0}^k(-1)^i\binom{k}{i}(m-i)^n
$$

æ€»ç­”æ¡ˆä¸º
$$
(m+1)^{-n}\sum_{k=0}^mk\sum_{i=0}^k(-1)^i\binom{k}{i}(m-i)^n
$$

å…ˆä¸çœ‹å‰é¢çš„åˆ†æ¯ï¼Œä¸Šå¼ç­‰äº

$$
\sum_i(-1)^i(m-i)^n\sum_{k\le m}k\binom{k}{i}
$$

æˆ‘ä»¬å…³æ³¨å¼å­ $\sum_{k\le m}k\binom{k}{i}$ï¼Œæ³¨æ„å¸æ”¶æ’ç­‰å¼ $(k+1)\binom{k}{i}=(i+1)\binom{k+1}{i+1}$ï¼Œå®ƒå¯ä»¥åŒ–ç®€ä¸º

$$
\begin{aligned}
    \sum_{k\le m}k\binom{k}{i}&=\sum_{k=i}^m(k+1)\binom{k}{i}-\sum_{k\le m}\binom{k}{i}\\
    &=(i+1)\sum_{k=i}^m\binom{k+1}{i+1}-\sum_{k\le m}\binom{k}{i}\\
    &=(i+1)\binom{m+2}{i+2}-\binom{m+1}{i+1}\\
\end{aligned}
$$

è€ƒè™‘åˆ†ä¸ºä¸¤é¡¹ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘çœ‹èµ·æ¥æ¯”è¾ƒç®€å•çš„

$$
\begin{aligned}
    &\sum_i(-1)^i(m-i)^n\binom{m+1}{i+1}\\
    &=\sum_i(-1)^{m-i}\binom{m+1}{i}i^n\\
    &=\sum_i(-1)^{m-i}\binom{m+1}{i}\sum_j{n\brace j}\binom{i}{j}j!\\
    &=\sum_j\binom{m+1}{j}{n\brace j}j!\sum_i(-1)^{m-i}\binom{m+1-j}{i-j}\\
    &=\sum_j\binom{m+1}{j}{n\brace j}j!\sum_i(-1)^i\binom{m+1-j}{i+1}\\
    &=-\sum_j\binom{m+1}{j}{n\brace j}j![m+1=j]\\
    &=-(m+1)!{n\brace m}\\
\end{aligned}
$$

ç„¶åæ˜¯

$$
\begin{aligned}
    &\sum_i(-1)^i(m-i)^n(i+1)\binom{m+2}{i+2}\\
    &=...
\end{aligned}
$$

çœŸæ˜¯ä»¤äººç¥æ¸…æ°”çˆ½çš„æ¨å¼å­å•Šï¼ˆæ¨åäº†

## Vivid Colors

$$
(R,G,B)=\left(\frac{1}{k}\sum_{i=1}^kr_i,\frac{1}{k}\sum_{i=1}^kg_i,\frac{1}{k}\sum_{i=1}^kb_i\right)\\~\\
\begin{aligned}
    &\operatorname{Var}\{R,G,B\}\\
    &=\frac{(R-\mu)^2+(G-\mu)^2+(B-\mu)^2}{3}\\
    &=\frac{(2R-G-B)^2+(2G-R-B)^2+(2B-R-G)^2}{27}\\
    &=\frac{(3R-3B)^2+3(2G-R-B)^2}{54}\\
    &=\frac{(\sum_{i=1}^k(r_i-b_i))^2+(\sum_{i=1}^k\sqrt 3(2g_i-r_i-b_i))^2}{18k^2}\\
\end{aligned}
$$

æ‰€ä»¥é—®é¢˜åªä¸ $p_i=(r_i-b_i,\sqrt 3(2g_i-r_i-b_i))$ æœ‰å…³ã€‚

ç„¶åç›¸å½“äºç»™å‡ºä¸€å †å‘é‡ï¼Œé€‰å‡ºå…¶ä¸­ $k$ ä¸ªï¼Œæœ€å¤§åŒ–å‘é‡å’Œçš„æ¨¡é•¿ã€‚

æˆ‘ä»¬è€ƒè™‘å…ˆå›ºå®šæ–¹å‘å‘é‡ $(\cos\theta,\sin\theta)$ï¼Œç„¶åç­‰äºæ¯ä¸ªå‘é‡åˆ°è¿™ä¸ªæ–¹å‘å‘é‡çš„ç‚¹ç§¯ä¹‹å’Œï¼Œå³

$$
\begin{aligned}
    &\left(\sum_{i=1}^kx_i\right)^2+\left(\sum_{i=1}^ky_i\right)^2\\
    &=\max_{\theta} \left(\sum_{i=1}^kx_i\cos\theta+y_i\sin\theta\right)^2
\end{aligned}
$$

è€ƒè™‘æšä¸¾è¿™ä¸ª $\theta$ï¼Œç„¶åæŒ‰ç…§ $a_i=x_i\cos\theta+y_i\sin\theta$ æ’åºï¼Œç„¶åå°±èƒ½å¯¹äºæ¯ä¸ª $k$ è¿›è¡Œæ›´æ–°ã€‚

æœ‰ç”¨çš„ $\theta$ æœ‰ $O(N^2)$ ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åªè€ƒè™‘å˜åŒ–äº†çš„ç‚¹ï¼Œç„¶åå°±èƒ½åšåˆ° $O(N^2\log N)$ã€‚

## Do Not Turn Back

å¦‚æœä¸è€ƒè™‘ã€ŒåŒã˜è¾ºã‚’é€£ç¶šã—ã¦é€šã‚‰ãªã„ã€çš„æ¡ä»¶å°±å¯ä»¥ç›´æ¥çŸ©é˜µå¿«é€Ÿå¹‚ã€‚

ç›´æ¥å®¹æ–¥æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå®¹æ–¥çš„è¿‡ç¨‹èå…¥åˆ°çŸ©é˜µä¸­ã€‚

æˆ‘ä»¬è®° $X_k$ è¡¨ç¤ºç»è¿‡ $k$ æ¡è¾¹çš„ç­”æ¡ˆï¼Œåˆ™

$$
X_0=I\\
X_1=A\\
X_2=A^2-D\\
X_k=AX_{k-1}-(D-I)X_{k-2}
$$

ç„¶åä½ å‘ç°è¿™ä¸ªä¸œè¥¿ä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªå¤åˆçš„çŸ©é˜µä¹˜æ³•ã€‚
$$
\begin{bmatrix}
    X_k\\
    X_{k-1}
\end{bmatrix}
=
\begin{bmatrix}
    A&-D+I\\
    I&0
\end{bmatrix}
\begin{bmatrix}
    X_{k-1}\\
    X_{k-2}
\end{bmatrix}
$$

ç„¶åå°±åšå®Œäº†ã€‚

## 0100 Insertion

æ³¨æ„åˆ°è¿™ä¸ªè‰¯ã„æ–‡å­—åˆ—æ˜¯å¯ä»¥æ­£åˆ™è¡¨è¾¾çš„ã€‚

è®° $s$ è¡¨ç¤ºè‰¯ã„æ–‡å­—åˆ—çš„é›†åˆï¼Œåˆ™
$$
s=s0s1s0s0s|\varnothing
$$

å¯ä»¥æŠŠå®ƒè¡¨ç¤ºæˆ DFA çš„å½¢å¼ï¼Œç„¶åç›´æ¥åœ¨ä¸Šé¢ DP å³å¯ã€‚

## Sub Brackets

è€ƒè™‘æŒ‰ç…§ $L$ çš„å¥‡å¶æ€§å¯¹åŒºé—´è¿›è¡Œåˆ†ç±»ã€‚

ä½ å‘ç°ä¸¤ä¸ªç›¸äº¤åŒºé—´å¥‡å¶æ€§ä¸åŒæ—¶ï¼Œä¼šå‘ç”ŸçŸ›ç›¾ã€‚

é™¤æ­¤ä¹‹å¤–åº”è¯¥éƒ½æ˜¯åˆæ³•çš„ã€‚

ç„¶ååº”è¯¥æ€ä¹ˆåšéƒ½è¡Œï¼Œå¯ä»¥çº¿æ®µæ ‘ä¼˜åŒ–å»ºè¾¹è·‘ 2-SAT åšåˆ° $O(N\log N)$ã€‚

ç›´æ¥çˆ†æ ‡äº†ï¼ˆï¼ˆ