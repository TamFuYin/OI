# CF2161

## D

互换 $a$ 的定义域和值域，即变成一个很简单的 DP

## E

记 $d_l$ 表示 $[l,l+k-1]$ 中 $1$ 的个数减去 $0$ 的个数，注意到 $d_i=d_{i-1}+s_{i+k-1}-s_{i-1}$，这里我们把 $s$ 中的 $0$ 替换为 $-1$。

怎么快速判断一个 $s$ 是否合法？

不妨假设 $d_1>0$，考虑找到第一个 $d_i=1$，则显然必然有 $s_{i-1}=1$。

注意到我们必然要求 $1\sim i$ 的 $s_j=1$，因此

- 如果 $s_{i+1}=1$，则我们必然要求 $s_{i+k}=1$，且维持 $d_{i+1}=1$；
- 否则，我们必然要求 $s_{i+k}=-1$，然后 $d_{i+1}=-1$。

于是我们发现 $d$ 一定形如从一个正数 $d_1$ 跌下来，然后一直在 $1$ 和 $-1$ 徘徊。

这个前缀要求 $s$ 全部等于 $1$，后面的东西可以用简单的 DP 解决。

## F

设 $C(x)$ 为仅保留权值 $\le x$ 的边的连通块数量，则 Kruskal  算法可以写成下式：
$$
\mathrm{MST}=\sum_x x(C(x-1)-C(x))=\sum_x C(x)
$$

也是一个类似 0/1 分组的东西。

因此我们只要求出对于每个 $\le x$ 的边生成的图，对于每个点集的连通块个数即可。

如果这张图是直接给定的，那这个其实是 #P-hard 的，但是边权以树上距离的形式给出，就很好。

不会

## G

考虑如果是 $a_1\cap a_2\cap \dots\cap a_n\subseteq X$，那么就很简单了，因为可以对每一个 $a_i$ 分别做，找到第一个 $a_i$ 为 $0$ 但 $X$ 为 $1$ 的位，然后前面不变，后面跟 $X$ 一样即可。

但是可能出现 $a_i$ 的 and 中为 $1$ 但是 $X$ 中为 $0$ 的位。

我们记上面找到的「第一个 $a_i$ 为 $0$ 但 $X$ 为 $1$ 的位」为 $b_i$，则这样的位只可能出现在 $>\max b_i$ 的位中，此时所有 $a_i$ 都不变。

我们找到所有这样的位的最大值，然后选一个 $a_i$ 把位给进了，但是可能进到一个新的位但是恰好使他不满足了。

阿阿阿好麻烦。

## H

根据经典结论，我们可以把它分为 $\le x$ 和 $>x$，变成 0/1。

用类似整体二分的方法处理即可。

然后就做完了？
