## 语言学

按照后三位分类，用类似 seg beats 的技巧。

## 数列

首先数列是好的当且仅当对于每个质数，其指数都是一个单峰函数。

然后给出的 $\gcd({b'}_i/b_i,b_i)=1$ 的意思是对于每个质数，如果 $b_i$ 在这里为 $0$，则允许 ${b'}_i\ne b_i$。

考虑如何快速计算 $f$，对于每个质数，根据其出现位置把答案分为若干段，显然每段的答案是独立的。

如果区间完全覆盖这一段，则可以用插板法算出贡献。

但是如果区间与这一段有交，则这个组合数与 $l$ 或 $r$ 有关，就很困难，我想了很久。

注意到指数实际上很小，是 $O(\log V)$ 级别的，所以这个组合数的次数也很小。

不妨把关于 $l$ 和关于 $r$ 的贡献分开计算，然后算出这个函数，对于每个次数分别算上贡献。

这个其实是一个类似插值的东西，比直接做多项式乘法好得多。

然后就做完了，也是一个二维偏序 like 的问题。